<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="fr" lang="fr-fr" itemscope="" itemtype="http://schema.org/Blog">
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; font-src 'self' http://fonts.googleapis.com/ http://fonts.gstatic.com; style-src 'self' 'unsafe-inline' http://fonts.googleapis.com; frame-src 'self' https://apis.google.com https://accounts.google.com; script-src 'self' http://code.jquery.com http://www.google-analytics.com https://apis.google.com; img-src 'self' http://www.google-analytics.com">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <meta name="description" content="Blog sur la qualité web en général, et l'automatisation de test web en particulier. Responsable tests et qualité web depuis 7 ans." />
  <meta name="keywords" content="test, watir, qualité, cucumber, jenkins, bug, selenium, appium, bournisien" />
  <meta name="robots" content="index,follow" />

  
  
    <title>Affichage des résultats de tests &middot; Je teste donc je suis</title>
    <meta property="og:title" content="Affichage des résultats de tests" />
    <meta property="og:url" content="/2013/06/17/affichage-des-resultats-de-tests/" />
    <meta property="og:type" content="article" />
  
  


  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700">

  <!-- Icons --
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">-->
  <link rel="shortcut icon" type="image/png" href="/public/qualite-min.jpg">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  <link rel="stylesheet" href="/public/fancybox/jquery.fancybox.css" type="text/css" media="screen" />

  <meta property="og:image"  content="/public/pictures/web-qualite.jpg"/>
  <meta itemprop="image"     content="/public/pictures/web-qualite.jpg" />
  <meta name="twitter:image" content="/public/pictures/web-qualite.jpg" />  
</head>

  <body class="theme-base-0c layout-reverse">
    <div class="content container">
      <div class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <h2 class="post-title" itemprop="name">Affichage des résultats de tests</h2>
  <span class="post-date">
	  <time class="date" datetime="2013-06-17" itemprop="datePublished">
		
		17
		juin
		  
		2013
	  </time>
	  - par Fabrice Bournisien
		
		- <a href="/tag/test">Test</a>
		
		- <a href="/tag/jenkins">Jenkins</a>
		
  </span>

	<div itemprop="ArticleBody"><p>Lorsqu&#39;on teste avec jenkins, cucumber et watir, on obtient des rapports détaillés, qu&#39;il faut lire et analyser en permanence.</p>

<p>Depuis plusieurs mois, nous avons dans nos locaux une télé dédiée à l&#39;affichage de l&#39;état général de l&#39;ensemble de nos tests. Pour cela, le plugin Jenkins Wall Display nous a suffit dans un premier temps. Nous affichons sur la télé une page web qui fait défiler</p>

<p>Au total, sur ces écrans, nous affichons le résumé :</p>

<ul>
<li>Plus de 1 300 test php unit (et leur 5 000 assertions)</li>
<li>Près de 500 tests unitaires JS</li>
<li>Plus de 950 scénarios cucumber pour les tests fonctionnels.</li>
</ul>

<p>En outre, nous affichons aussi quelques graphiques sensibles de l&#39;état de la production : nombre de compte crées, etc..
On a beau regrouper toutes ces informations, il arrive un moment où l&#39;affichage n&#39;est plus lisible.</p>

<p><img src="/public/pictures/2013/screen-avant.jpg" alt="Exemple avec les tests fonctionnels" title="Affichage avant les travaux"></p>

<p>Le constat est moins alarmant pour les tests unitaires. Les chiffres exposent bien pourquoi :</p>

<ul>
<li>Tests fonctionnels : 40 jobs jenkins * 3 navigateurs</li>
<li>Tests unitaires : 18 jobs jenkins * 2 environnement</li>
</ul>

<h3>Comment afficher proprement les résultats</h3>

<p>Je suis parti en quête d&#39;une solution pour afficher tous nos résultats proprement, avec quelques contraintes :</p>

<ul>
<li>Je préférais afficher tous les résultats sur un seul écran par type de tests</li>
<li>Je veux pouvoir afficher un résumé ( x tests KO / x tests total)</li>
<li>Je veux pouvoir séparer facilement les affichages d&#39;un même type de tests (par navigateur / environnement)</li>
</ul>

<p>Ma quête fut longue et semée d&#39;embûches :</p>

<ul>
<li>Tentative d&#39;utilisation de l&#39;API, mais c&#39;était déjà trop lent alors que je ne calculais / affichais pas la moitié de ce que je voulais (45 secondes environ)</li>
<li>Plusieurs plugin jenkins, mais aucun ne permettant ce que je veux</li>
<li>Un Plugin jenkins faisant la moitié de ce que je voulais, mais complètement bugué</li>
</ul>

<h3>Mon premier plugin jenkins</h3>

<p>Je suis donc parti à l&#39;assaut de la documentation de jenkins pour coder un plugin fait-maison qui ferait exactement ce que je voudrais.</p>

<p>Ce que j&#39;ai bien aimé dans cette création :</p>

<ul>
<li>Tout en java. Je n&#39;avais pas codé en java depuis 10 ans je pense, et j&#39;ai perdu, mais vite repris mes repères.</li>
<li>Bosser sur un plugin que je pourrais diffuser en open-source à la fin :)</li>
<li>La possibilité de faire exactement ce que je veux, sans être limité par un plugin déjà fait.</li>
</ul>

<p>Ce que je n&#39;ai pas aimé :</p>

<ul>
<li>La documentation : elle existe, elle semble complète. Mais je trouve l&#39;organisation moyennement bonne. J&#39;ai plusieurs fois été à la recherche d&#39;exemple de code pour trouver la fonction dont j&#39;avais besoin, que je ne trouvais pas dans la doc.</li>
<li>L&#39;installation de maven qui marche du premier coup sur un de mes postes, mais se passe mal sur l&#39;autre.</li>
</ul>

<h3>Au final, ça donne quoi ?</h3>

<p>J&#39;ai donc un plugin qui permet de créer une nouvelle &quot;View&quot;. On peut y configurer :</p>

<ul>
<li>Les noms des colonnes, et la façon de filtrer les jobs dans chaque colonne, par des expression régulières.</li>
<li>Affichage dans chaque colonne du temps pris pour ces tests, du nombre de scénarios en échec et du nombre total de scénarios. (Afficher le nombre de jobs est beaucoup plus simple, mais donne beaucoup moins d&#39;informations : un job en échec pour 1 / 34 est moins grave qu&#39;un test avec 4 / 4 erreurs)</li>
<li>Affichage de la liste des jobs en échec (avec le nombre de scénarios)</li>
<li>Une colonne à part, qui affiche le temps total sur jenkins (master + slave)</li>
<li>Une liste de jobs spéciaux (dans mon cas : ceux qui lancent les autres, la génération de la doc...)</li>
</ul>

<p>Le plugin est sur github : <a href="https://github.com/fabrice31/CucumberJenkins">https://github.com/fabrice31/CucumberJenkins</a></p>

<p>Et maintenant ?</p>

<p>J&#39;ai configuré le plugin pour fonctionner avec cucumber, puisque je suis au coeur des tests fonctionnels. Il faut maintenant que je me débrouille pour que cet affichage fonctionne aussi bien avec tests php unit (séparés par des regexp par environnement cette fois)</p>

<p><img src="/public/pictures/2013/screen-apres.jpg" alt="Affichage de résultats cucumber" title="Affichage apres les travaux">
<img src="/public/pictures/2013/screen-config.jpg" alt="Plugin jenkins affichage de résultats cucumber" title="Configuration du plugin"></p>
</div>

	<!--div class="share">
		<div class="twitter-share">
			<iframe src="http://platform.twitter.com/widgets/tweet_button.html?url=http%3A%2F%2Fblog.fabricebournisien.eu%2F%2F2013%2F06%2F17%2Faffichage-des-resultats-de-tests%2F&amp;via=fabrice31&amp;text=Affichage des résultats de tests&amp;lang=fr&amp;count=horizontal" frameborder="0" allowTransparency="1" scrolling="no" style="height:20px;width:133px;"></iframe>
		</div>
		<div class="facebook-share">
			<iframe src="//www.facebook.com/plugins/like.php?href=http://blog.fabricebournisien.eu//2013/06/17/affichage-des-resultats-de-tests/&amp;send=false&amp;layout=button_count&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font" frameborder="0" allowTransparency="1" scrolling="no" style="height:20px;width:133px;"></iframe>
		</div>
		<div class="google-share">
			<iframe src="https://plusone.google.com/u/0/_/+1/fastbutton?url=http://blog.fabricebournisien.eu//2013/06/17/affichage-des-resultats-de-tests/&amp;size=medium&amp;annotation=bubble&amp;lang=fr" frameborder="0" allowTransparency="1" scrolling="no" style="height:20px;width:90px;"></iframe>
		</div>
	</div-->

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
		  <a href="http://blog.fabricebournisien.eu//2015/09/28/empirique-service-tests/">
			L'empirique au service des tests
			<small>28 Sep 2015</small>
		  </a>
      </li>
    
      <li>
		  <a href="http://blog.fabricebournisien.eu//2015/01/15/kiss-simple-n-est-pas-toujours-simple/">
			La simplicité n'est pas toujours simple
			<small>15 Jan 2015</small>
		  </a>
      </li>
    
      <li>
		  <a href="http://blog.fabricebournisien.eu//2015/01/07/petits-plaisirs-de-la-vie/">
			Petits plaisirs de la vie
			<small>07 Jan 2015</small>
		  </a>
      </li>
    
  </ul>
</div>

<script src="https://apis.google.com/js/plusone.js"></script>
<div class="g-comments"
    data-href="http://blog.fabricebournisien.eu//2013/06/17/affichage-des-resultats-de-tests/"
    data-width="642"
    data-first_party_property="BLOGGER"
    data-view_type="FILTERED_POSTMOD">
</div>

    </div>
    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Je teste donc je suis
        </a>
      </h1>
      <p class="lead">Blog d'un automatiseur de tests web.</p>
    </div>

    <nav class="sidebar-nav">
      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/archive/">Archives</a>
          
        
      
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
	  <a class="sidebar-nav-item" href="http://www.fabricebournisien.eu">CV</a>
	  <!-- SiteSearch Google --> 
	  <form method="get" action="http://www.google.com/search"> 
		<input type="hidden" name="ie" value="UTF-8" /> 
		<input type="hidden" name="oe" value="UTF-8" /> 
		<input type="hidden" name="domains" value="blog.fabricebournisien.eu" /> 
		<input type="hidden" name="sitesearch" value="blog.fabricebournisien.eu" checked="checked" />
		<input type="text" name="q" size="18" maxlength="255" value="" title="Chercher sur le blog" />
		<input type="submit" name="btnG" value="Chercher" /> 
	  </form>
	  <!-- SiteSearch Google -->
    </nav>

    <p>&copy; 2015 - <a href="https://plus.google.com/104493142924184161356" rel="author">Fabrice Bournisien</a></p>
  </div>
</div>


  <script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
  <script type="text/javascript" src="/public/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/public/js/script.js"></script>
  </body>
</html>
